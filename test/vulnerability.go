package test

import (
	"fmt"

	"github.com/quay/claircore"
)

func GenUniqueVulnerabilities(n int, updater string) []*claircore.Vulnerability {
	if n == 0 {
		return nil
	}
	vulns := []*claircore.Vulnerability{}
	for i := 0; i < n; i++ {
		vulns = append(vulns, &claircore.Vulnerability{
			ID:          i,
			Updater:     updater,
			Name:        fmt.Sprintf("test-vuln-%d", i),
			Description: fmt.Sprintf("test-vuln-desc-%d", i),
			Links:       fmt.Sprintf("test-vuln-links-%d", i),
			Severity:    fmt.Sprintf("test-severity-%d", i),
			Package: &claircore.Package{
				ID:      i,
				Name:    fmt.Sprintf("package-%d", i),
				Version: fmt.Sprintf("version-%d", i),
				Kind:    "binary",
				// Dist: &claircore.Distribution{
				// 	ID:              i,
				// 	Name:            fmt.Sprintf("dist-%d", i),
				// 	Version:         fmt.Sprintf("version-%d", i),
				// 	VersionCodeName: fmt.Sprintf("version%d", i),
				// 	VersionID:       fmt.Sprintf("%d", i),
				// 	Arch:            "x86_64",
				// },
			},
		})
	}

	return vulns
}
