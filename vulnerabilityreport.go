package claircore

// Details provide further context for a discoverd package within an image
type Details struct {
	// the package database this file was discovered
	PackageDB string `json:"package_db"`
	// the layer hash within the image the package was introduced
	IntroducedIn string `json:"introduced_in"`
}

// VulnerabilityReport provides a report of packages and their
// associated vulnerabilities.
type VulnerabilityReport struct {
	// manifest hash this vulnerability report is describing
	Hash string `json:"manifest_hash"`
	// a map, keyed by vulnerability id, of all vulnerabilities found in the layer
	Vulnerabilities map[int]*Vulnerability `json:"vulnerabilities"`
	// a map, keyed by package id, of all packages found within the image
	Packages map[int]*Package `json:"packages"`
	// a map, keyed by package, id providing the context in which a package was found
	Details map[int][]*Details `json:"details"`
	// a map, keyed by package id, associating 0 or more vulnerabilities ID
	PackageVulnerabilities map[int][]int `json:"package_vulnerabilities"`
}
